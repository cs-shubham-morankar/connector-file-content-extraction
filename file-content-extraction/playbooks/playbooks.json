{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - File Content Extraction - 1.0.0",
      "description": "Sample playbooks for \"File Content Extraction\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/5b3e5fa7-673f-426a-9505-5176b5a5eab5",
      "uuid": "2ecf139d-2979-4658-a954-90f02bc9e93d",
      "id": 111,
      "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "createDate": 1640761612,
      "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
      "modifyDate": 1640761612,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Backend Config Details",
          "aliasName": null,
          "tag": null,
          "description": "Get The Backend Configuration Details",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638956213,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4ec5928d-4f86-4e43-8642-ebadde48a281",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Results",
              "description": null,
              "arguments": {
                "backend_config": "{{vars.steps.Get_backend_Config_Details.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2980885a-595e-4847-aa36-020879a7b9f2",
              "id": 5439
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "b04fb0f4-5b2a-415b-a09b-d17f2a8ce431",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "4ec5928d-4f86-4e43-8642-ebadde48a281",
              "id": 5440
            },
            {
              "@type": "WorkflowStep",
              "name": "Get backend Config Details",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "1600b39c-a71b-4f63-a86e-908b10f14860",
                "params": {
                  "verbose_config": true
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "get_backend_config",
                "operationTitle": "Get Backend Config",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "id": 5441
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Details",
              "targetStep": "/api/3/workflow_steps/94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "sourceStep": "/api/3/workflow_steps/4ec5928d-4f86-4e43-8642-ebadde48a281",
              "label": null,
              "isExecuted": false,
              "uuid": "b913b4eb-6ecc-4177-8009-347c1422ca01"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Details -> Compute Results",
              "targetStep": "/api/3/workflow_steps/2980885a-595e-4847-aa36-020879a7b9f2",
              "sourceStep": "/api/3/workflow_steps/94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "label": null,
              "isExecuted": false,
              "uuid": "e4a19a8f-9978-46c3-8e32-910b92a4b981"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3c5a9190-3eaf-4000-babb-1d41a8a2236f",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1272,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1640761612,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1640761612,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract Text From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text and Meta data from MS Office, PDF and other file types",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638265855,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ea6affff-6836-4c4a-a77e-3e816de9317d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Extract text",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0].file['@id']}}",
                  "html_output_format": false
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_text",
                "operationTitle": "Extract Text",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "id": 5442
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ad2fc42a-d566-443d-996e-5c7bc8062022",
                "resources": [
                  "indicators",
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "display": "File",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "ea6affff-6836-4c4a-a77e-3e816de9317d",
              "id": 5443
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "extraction_result": "{{vars.steps.Extract_text.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f11bd301-3bd2-4906-af12-1950d8c567ba",
              "id": 5444
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/f11bd301-3bd2-4906-af12-1950d8c567ba",
              "sourceStep": "/api/3/workflow_steps/1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "label": null,
              "isExecuted": false,
              "uuid": "4b6e77a2-342c-4d80-93c0-714b66336478"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract text",
              "targetStep": "/api/3/workflow_steps/1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "sourceStep": "/api/3/workflow_steps/ea6affff-6836-4c4a-a77e-3e816de9317d",
              "label": null,
              "isExecuted": false,
              "uuid": "ab356a3c-9894-40be-9fd8-34bc74d84e38"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "4ad33531-45ee-498a-9158-574660803611",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1273,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1640761612,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1640761612,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract Artifacts From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text and Meta data from MS Office, PDF and other file types",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638267127,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a0e42486-b942-49cb-943c-e0679b40e3e1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "extraction_result": "{{vars.steps.Extract_Artifacts.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7b1cb3bf-6967-4f98-b12c-577fbe7ea5b8",
              "id": 5445
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Artifacts",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0]['@id']}}"
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_indicators",
                "operationTitle": "Extract Artifacts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "id": 5446
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8c3e93c0-e407-4ad3-83e4-a912a3964193",
                "resources": [
                  "indicators",
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "display": "File",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "a0e42486-b942-49cb-943c-e0679b40e3e1",
              "id": 5447
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract text",
              "targetStep": "/api/3/workflow_steps/881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "sourceStep": "/api/3/workflow_steps/a0e42486-b942-49cb-943c-e0679b40e3e1",
              "label": null,
              "isExecuted": false,
              "uuid": "c0ea5ca7-cf31-47f7-b4f0-886a35f21a86"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/7b1cb3bf-6967-4f98-b12c-577fbe7ea5b8",
              "sourceStep": "/api/3/workflow_steps/881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "label": null,
              "isExecuted": false,
              "uuid": "da1ec781-8613-4cc4-8b57-8ea3061f61e4"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "84dfdba4-ce4b-451d-a29e-ede8d29c9a9c",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1274,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1640761612,
          "modifyUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "modifyDate": 1640761612,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> JSON to HTML Tables",
          "aliasName": null,
          "tag": null,
          "description": "Takes a list of JSON dictionaries and creates an HTML table for each",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "json_data"
          ],
          "synchronous": false,
          "lastModifyDate": 1641121526,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a6cea4c7-0da2-4f8a-a0e2-9f7de04b3c07",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "list_of_lists": "[]"
                }
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "a6cea4c7-0da2-4f8a-a0e2-9f7de04b3c07",
              "id": 5448
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "columns_per_table": "9"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "add59555-4c0a-41e5-9ed8-bcff87a5c2d9",
              "id": 5449
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Lists of Lists",
              "description": null,
              "arguments": {
                "__temp0": "{%for line in vars.input.params.json_data.items()|batch(vars.columns_per_table)%}\n{{vars.list_of_lists.append(dict(line))}}{%endfor%}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "c1181a5b-16dd-48e2-babb-9d04a58caeb4",
              "id": 5450
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute HTML output",
              "description": null,
              "arguments": {
                "data": "{%for sublist in vars.list_of_lists%}{%if sublist%}<div style=\"float:left; border:2px solid grey; margin:5px;background-color: #1b2430; color:white;font-size:16;\">\n    <h6 style=\"background:#22a6af;color:white;padding:5px;\">Metadata</h2>\n    <p style=\"padding:1px;color:white;\">{{sublist | json2html(row_fields=[], template=\"Stylized with row selection\", display=\"Vertical\", styling=false, table_style={})}}<br>\n    </p>\n</div>{%endif%}{%endfor%}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "d9a996d2-a3e6-4e9f-a43f-8affea49c995",
              "id": 5451
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/add59555-4c0a-41e5-9ed8-bcff87a5c2d9",
              "sourceStep": "/api/3/workflow_steps/a6cea4c7-0da2-4f8a-a0e2-9f7de04b3c07",
              "label": null,
              "isExecuted": false,
              "uuid": "12480a71-9461-45d6-9158-a9af75e118c3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Lists of Lists -> Compute HTML output",
              "targetStep": "/api/3/workflow_steps/d9a996d2-a3e6-4e9f-a43f-8affea49c995",
              "sourceStep": "/api/3/workflow_steps/c1181a5b-16dd-48e2-babb-9d04a58caeb4",
              "label": null,
              "isExecuted": false,
              "uuid": "4a37cefc-b1d9-4038-a068-7ed48e65052b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Compute Lists of Lists",
              "targetStep": "/api/3/workflow_steps/c1181a5b-16dd-48e2-babb-9d04a58caeb4",
              "sourceStep": "/api/3/workflow_steps/add59555-4c0a-41e5-9ed8-bcff87a5c2d9",
              "label": null,
              "isExecuted": false,
              "uuid": "dd294d3b-b2a4-494b-bea6-236faffe167c"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "9b384ae8-48a0-4261-9250-3292a74b053f",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1275,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1640761612,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641121526,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract and Process Text From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text, indicators and Meta data from MS Office, PDF and other files",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1641125700,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/af26e67d-7790-45be-aa69-ce167cafc916",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Extract text",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0].file['@id']}}",
                  "html_output_format": true
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_text",
                "operationTitle": "Extract Text",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "id": 5452
            },
            {
              "@type": "WorkflowStep",
              "name": "Format Metadata",
              "description": null,
              "arguments": {
                "arguments": {
                  "json_data": "{{vars.extraction_result.metadata}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/9b384ae8-48a0-4261-9250-3292a74b053f"
              },
              "status": null,
              "top": "570",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "3f0eb1cd-c448-46c9-b4d1-b2de07ffcd93",
              "id": 5453
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "description": "{{vars.input.records[0].description}}{%if 'filePreview' not in vars.input.records[0]%}\n<table>\n    <tr>\n      <td>{{vars.steps.Format_Metadata.data}}</td>\n    </tr>\n    <tr>\n        <td>\n            <hr>\n            <div style=\"float: left; flex-grow: 100; border:2px solid grey; margin:5px;background-color: #1b2430; color:white;font-size:16;\">\n                <h6 style=\"background:#bff7ff;color:black;padding:5px;\">File Preview</h2>\n                <p style=\"padding:1px;color:white;\">\n                    {{vars.extraction_result.extracted_text}}\n                </p>\n            </div>\n        </td>\n      </tr>\n  </table>\n{%endif%}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "974",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "7d8a8527-3612-4918-b754-8524a80c1668",
              "id": 5454
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "whitelist": "{{vars.ips | union(vars.urls) |union(vars.domains)}}",
                "alerts_iris": "{%if vars.record_data.alerts|length >0%}\n{{vars.record_data|json_query(\"alerts[].[\\\"@id\\\"]\")|flatten(levels=1)}}\n{%endif%}",
                "extraction_result": "{{vars.steps.Extract_text.data}}",
                "extracted_indicators": "{{vars.steps.Extract_text|extract_artifacts}}"
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7fe93626-1500-436f-ac39-679f633dab41",
              "id": 5455
            },
            {
              "@type": "WorkflowStep",
              "name": "Whitelist Indicators",
              "description": null,
              "arguments": {
                "__temp0": "{%for indicator in vars.extracted_indicators.results%}\n{%if indicator.value not in vars.whitelist%}{{vars.unified_iocs.append(indicator)}}{%endif%}\n{%endfor%}"
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "88edc781-d199-49de-ad68-7668b6699f6d",
              "id": 5456
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "507b86a8-3d73-4820-bf55-a4373eba5608",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "af26e67d-7790-45be-aa69-ce167cafc916",
              "id": 5457
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Indicators",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.unified_iocs}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "tlp": {
                    "id": 313,
                    "@id": "/api/3/picklists/7bff95b7-6438-4b01-b23a-0fe8cb5b33d3",
                    "icon": null,
                    "uuid": "7bff95b7-6438-4b01-b23a-0fe8cb5b33d3",
                    "@type": "Picklist",
                    "color": "#FFBF00",
                    "display": "Amber",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/40f1345f-f679-43c0-9237-5b06edd8385f",
                    "itemValue": "Amber",
                    "orderIndex": 1
                  },
                  "value": "{{vars.item.value}}",
                  "__link": {
                    "alerts": "{{vars.alerts_iris}}",
                    "indicators": "{{vars.input.records[0]['@id']}}"
                  },
                  "__replace": "true",
                  "indicatorStatus": {
                    "id": 369,
                    "@id": "/api/3/picklists/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "TBD",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "typeofindicator": "{{('IndicatorType' | picklist(vars.item.type))['@id']}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "/api/3/upsert/indicators",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "839",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "id": 5458
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": "You can customize extraction by modifying indicator map in configuration step",
              "arguments": {
                "ips": "{{globalVars.Excludelist_IPs.split(',')}}",
                "urls": "{{globalVars.Excludelist_URLs.split(',')}}",
                "domains": "{{globalVars.Excludelist_Domains.split(',')}}",
                "record_data": "{{(vars.input.records[0]['@id']+'?$relationships=true')|fromIRI}}",
                "unified_iocs": "[]"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "id": 5459
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Compute results -> Format Metadata",
              "targetStep": "/api/3/workflow_steps/3f0eb1cd-c448-46c9-b4d1-b2de07ffcd93",
              "sourceStep": "/api/3/workflow_steps/7fe93626-1500-436f-ac39-679f633dab41",
              "label": null,
              "isExecuted": false,
              "uuid": "0aeac041-5b46-4c69-b64c-8e33c43c8e38"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Format Metadata -> Whitelist Indicators",
              "targetStep": "/api/3/workflow_steps/88edc781-d199-49de-ad68-7668b6699f6d",
              "sourceStep": "/api/3/workflow_steps/3f0eb1cd-c448-46c9-b4d1-b2de07ffcd93",
              "label": null,
              "isExecuted": false,
              "uuid": "1fd7adb0-406c-445f-ae75-2d581049aa8f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/7fe93626-1500-436f-ac39-679f633dab41",
              "sourceStep": "/api/3/workflow_steps/1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "label": null,
              "isExecuted": false,
              "uuid": "5c200b93-8033-45fe-8487-98afba6d1c8c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Whitelist Indicators -> Create Indicators",
              "targetStep": "/api/3/workflow_steps/c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "sourceStep": "/api/3/workflow_steps/88edc781-d199-49de-ad68-7668b6699f6d",
              "label": null,
              "isExecuted": false,
              "uuid": "b8aaa6ed-2212-4681-a1e2-ba7dc075e31c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Extract text",
              "targetStep": "/api/3/workflow_steps/1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "sourceStep": "/api/3/workflow_steps/e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "label": null,
              "isExecuted": false,
              "uuid": "bd496cac-9af5-4b65-b3b1-6310b0e91fad"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Indicators -> Update Record",
              "targetStep": "/api/3/workflow_steps/7d8a8527-3612-4918-b754-8524a80c1668",
              "sourceStep": "/api/3/workflow_steps/c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "label": null,
              "isExecuted": false,
              "uuid": "e14c8a11-5c02-4223-bab9-39ef144d3646"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "sourceStep": "/api/3/workflow_steps/af26e67d-7790-45be-aa69-ce167cafc916",
              "label": null,
              "isExecuted": false,
              "uuid": "2c0037a8-cd19-418f-bb72-901a15c3561f"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cddbc41c-740e-48f0-9657-9867b9254a4b",
          "recordTags": [
            "Use-Case",
            "file-content-extraction"
          ],
          "id": 1276,
          "createUser": "/api/3/appliances/57545210-2adc-472b-a24f-2df6ee8dfe63",
          "createDate": 1640761612,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1641125700,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "macros": [
    {
      "name": "Excludelist_IPs",
      "value": "8.8.8.8,10.1.1.2,151.205.102.42,10.0.1.1",
      "default_value": "8.8.8.8,10.1.1.2"
    },
    {
      "name": "Excludelist_URLs",
      "value": "https://www.google.com,https://mail.yahoo.com/login.html,https://www.office.com/",
      "default_value": "https://www.google.com,https://mail.yahoo.com/login.html,https://www.office.com/"
    },
    {
      "name": "Excludelist_Domains",
      "value": "google.com,yahoo.com,fortinet.net,cybersponse.com,gmail.com,outlook.com,microsoft.com,fortielab.com",
      "default_value": "google.com,yahoo.com,fortinet.net,cybersponse.com,gmail.com,outlook.com,microsoft.com,fortielab.com"
    }
  ],
  "exported_tags": [
    "file-content-extraction",
    "Use-Case"
  ]
}