{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - File Content Extraction - 1.0.0",
      "description": "Sample playbooks for \"File Content Extraction\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/7dc86641-7065-4ba6-9c86-c10e9203bd19",
      "uuid": "2ecf139d-2979-4658-a954-90f02bc9e93d",
      "id": 167,
      "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "createDate": 1638265857,
      "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
      "modifyDate": 1638265857,
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Check Required Indicator Fields",
          "aliasName": null,
          "tag": null,
          "description": "checks whether the Indicator fields: teCookie (type text) and reportsIDs (type JSON) are present",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638265855,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/53e03e9c-38a9-4329-b1c5-1c0df2ccae5d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "uuid": "53e03e9c-38a9-4329-b1c5-1c0df2ccae5d",
              "id": 9246
            },
            {
              "@type": "WorkflowStep",
              "name": "Raise Exception",
              "description": null,
              "arguments": {
                "when": "{{'filePreview' not in vars.input.records[0]}}",
                "params": {
                  "msg": "Cannot find required fields: filePreview: Please add a 'filePreview' field with a type: 'Rich Text' to the Indicator module (Settings > Modules > Indicators)."
                },
                "version": "3.0.5",
                "connector": "cyops_utilities",
                "operation": "raise_exception",
                "operationTitle": "Utils: Raise Exception",
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "a48eca9f-5b2c-4e8c-97eb-a39f7420b829",
              "id": 9245
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Raise Exception",
              "targetStep": "/api/3/workflow_steps/a48eca9f-5b2c-4e8c-97eb-a39f7420b829",
              "sourceStep": "/api/3/workflow_steps/53e03e9c-38a9-4329-b1c5-1c0df2ccae5d",
              "label": null,
              "isExecuted": false,
              "uuid": "3a2f26cd-ccbd-4476-b01a-83c3b7ea99e9"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "1ae91783-5c2d-453e-a1c9-296d1e62f95c",
          "recordTags": [
            "Use-Case",
            "file-content-extraction"
          ],
          "id": 1819,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1638265857,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638265857,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Backend Config Details",
          "aliasName": null,
          "tag": null,
          "description": "Get The Backend Configuration Details",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638266363,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4ec5928d-4f86-4e43-8642-ebadde48a281",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute Results",
              "description": null,
              "arguments": {
                "backend_config": "{{vars.steps.Get_backend_Config_Details.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2980885a-595e-4847-aa36-020879a7b9f2",
              "id": 9248
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "b04fb0f4-5b2a-415b-a09b-d17f2a8ce431",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "4ec5928d-4f86-4e43-8642-ebadde48a281",
              "id": 9247
            },
            {
              "@type": "WorkflowStep",
              "name": "Get backend Config Details",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "1600b39c-a71b-4f63-a86e-908b10f14860",
                "params": {
                  "verbose_config": false
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "get_backend_config",
                "operationTitle": "Get Backend Config",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "id": 9249
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Details",
              "targetStep": "/api/3/workflow_steps/94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "sourceStep": "/api/3/workflow_steps/4ec5928d-4f86-4e43-8642-ebadde48a281",
              "label": null,
              "isExecuted": false,
              "uuid": "b913b4eb-6ecc-4177-8009-347c1422ca01"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Details -> Compute Results",
              "targetStep": "/api/3/workflow_steps/2980885a-595e-4847-aa36-020879a7b9f2",
              "sourceStep": "/api/3/workflow_steps/94da05b0-e89e-4436-b7ec-6a9dffcfc7ab",
              "label": null,
              "isExecuted": false,
              "uuid": "e4a19a8f-9978-46c3-8e32-910b92a4b981"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "3c5a9190-3eaf-4000-babb-1d41a8a2236f",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1820,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1638265857,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638266364,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract Text From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text and Meta data from MS Office, PDF and other file types",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638265855,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ea6affff-6836-4c4a-a77e-3e816de9317d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Extract text",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0].file['@id']}}",
                  "html_output_format": false
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_text",
                "operationTitle": "Extract Text",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "id": 9251
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "ad2fc42a-d566-443d-996e-5c7bc8062022",
                "resources": [
                  "indicators",
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "display": "File",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "ea6affff-6836-4c4a-a77e-3e816de9317d",
              "id": 9250
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "extraction_result": "{{vars.steps.Extract_text.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "f11bd301-3bd2-4906-af12-1950d8c567ba",
              "id": 9252
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract text",
              "targetStep": "/api/3/workflow_steps/1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "sourceStep": "/api/3/workflow_steps/ea6affff-6836-4c4a-a77e-3e816de9317d",
              "label": null,
              "isExecuted": false,
              "uuid": "ab356a3c-9894-40be-9fd8-34bc74d84e38"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/f11bd301-3bd2-4906-af12-1950d8c567ba",
              "sourceStep": "/api/3/workflow_steps/1eec2a56-a5f9-46a6-a7c8-01e3bff2001a",
              "label": null,
              "isExecuted": false,
              "uuid": "4b6e77a2-342c-4d80-93c0-714b66336478"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "4ad33531-45ee-498a-9158-574660803611",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1821,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1638265857,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638265857,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract Artifacts From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text and Meta data from MS Office, PDF and other file types",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638267127,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/a0e42486-b942-49cb-943c-e0679b40e3e1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "extraction_result": "{{vars.steps.Extract_Artifacts.data}}"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7b1cb3bf-6967-4f98-b12c-577fbe7ea5b8",
              "id": 9264
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Artifacts",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0]['@id']}}"
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_indicators",
                "operationTitle": "Extract Artifacts",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "id": 9262
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8c3e93c0-e407-4ad3-83e4-a912a3964193",
                "resources": [
                  "indicators",
                  "attachments"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "display": "File",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "a0e42486-b942-49cb-943c-e0679b40e3e1",
              "id": 9263
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Extract text",
              "targetStep": "/api/3/workflow_steps/881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "sourceStep": "/api/3/workflow_steps/a0e42486-b942-49cb-943c-e0679b40e3e1",
              "label": null,
              "isExecuted": false,
              "uuid": "c0ea5ca7-cf31-47f7-b4f0-886a35f21a86"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/7b1cb3bf-6967-4f98-b12c-577fbe7ea5b8",
              "sourceStep": "/api/3/workflow_steps/881516b0-0e0f-49ab-ba47-95c6fac0e910",
              "label": null,
              "isExecuted": false,
              "uuid": "da1ec781-8613-4cc4-8b57-8ea3061f61e4"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "84dfdba4-ce4b-451d-a29e-ede8d29c9a9c",
          "recordTags": [
            "file-content-extraction"
          ],
          "id": 1823,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1638266992,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638267128,
          "owners": [],
          "isPrivate": false
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Extract and Process Text From File",
          "aliasName": null,
          "tag": null,
          "description": "Extract text, indicators and Meta data from MS Office, PDF and other files",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1638265855,
          "collection": "/api/3/workflow_collections/2ecf139d-2979-4658-a954-90f02bc9e93d",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/af26e67d-7790-45be-aa69-ce167cafc916",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Extract text",
              "description": null,
              "arguments": {
                "name": "Text Extractor",
                "config": "70616ece-f92a-459b-88e5-cbf1b07b37b2",
                "params": {
                  "file_iri": "{{vars.input.records[0].file['@id']}}",
                  "html_output_format": true
                },
                "version": "1.0.0",
                "connector": "file-content-extraction",
                "operation": "extract_text",
                "operationTitle": "Extract Text",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "436",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "id": 9257
            },
            {
              "@type": "WorkflowStep",
              "name": "Check Required Fields",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": {
                  "record_data": "{{(vars.input.records[0]['@id']+'?$relationships=true')|fromIRI}}"
                },
                "workflowReference": "/api/3/workflows/1ae91783-5c2d-453e-a1c9-296d1e62f95c"
              },
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "uuid": "234bf8de-f247-474f-8614-e0f214a28ab7",
              "id": 9255
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "filePreview": "<p><span style=\"background-color: #236fa1;\"><strong>Metadata:</strong></span></p>\n<p>{{vars.steps.Format_File_Metadata.data}}</p>\n<hr />\n<p><span style=\"background-color: #236fa1;\"><strong>File Preview:</strong></span></p>\n<p><strong>{{vars.extraction_result.extracted_text}}</strong></p>"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "collectionType": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "486",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "7d8a8527-3612-4918-b754-8524a80c1668",
              "id": 9254
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute results",
              "description": null,
              "arguments": {
                "whitelist": "{{vars.ips | union(vars.urls) |union(vars.domains)}}",
                "alerts_iris": "{%if vars.record_data.alerts|length >0%}\n{{vars.record_data|json_query(\"alerts[].[\\\"@id\\\"]\")|flatten(levels=1)}}\n{%endif%}",
                "extraction_result": "{{vars.steps.Extract_text.data}}",
                "extracted_indicators": "{{vars.steps.Extract_text|extract_artifacts}}"
              },
              "status": null,
              "top": "571",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "7fe93626-1500-436f-ac39-679f633dab41",
              "id": 9258
            },
            {
              "@type": "WorkflowStep",
              "name": "Whitelist Indicators",
              "description": null,
              "arguments": {
                "__temp0": "{%for indicator in vars.extracted_indicators.results%}\n{%if indicator.value not in vars.whitelist%}{{vars.unified_iocs.append(indicator)}}{%endif%}\n{%endfor%}"
              },
              "status": null,
              "top": "29",
              "left": "486",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "88edc781-d199-49de-ad68-7668b6699f6d",
              "id": 9256
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "507b86a8-3d73-4820-bf55-a4373eba5608",
                "resources": [
                  "indicators"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "indicators": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                      {
                        "type": "object",
                        "field": "typeofindicator",
                        "value": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                        "_value": {
                          "@id": "/api/3/picklists/0162241b-f5bf-4917-a150-00e920be47bd",
                          "itemValue": "File"
                        },
                        "operator": "eq"
                      }
                    ]
                  },
                  "attachments": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "uuid": "af26e67d-7790-45be-aa69-ce167cafc916",
              "id": 9260
            },
            {
              "@type": "WorkflowStep",
              "name": "Format File Metadata",
              "description": null,
              "arguments": {
                "params": {
                  "data": "{{vars.extraction_result.metadata}}",
                  "display": "Horizontal",
                  "styling": false,
                  "template": "Stylized with row selection",
                  "row_fields": "[\"date\",\"Author\",\"creator\",\"modified\",\"protected\",\"publisher\",\"dc:creator\",\"Last-Author\",\"meta:author\",\"Content-Type\",\"resourceName\",\"Creation-Date\",\"Last-Modified\",\"Last-Save-Date\",\"meta:save-date\",\"dcterms:created\",\"Application-Name\",\"dcterms:modified\",\"meta:last-author\",\"meta:creation-date\",\"Application-Version\",\"X-TIKA:origResourceName\"]"
                },
                "version": "3.0.5",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
              },
              "status": null,
              "top": "707",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b4c730e5-50f3-4045-9890-22cce9ed1e7d",
              "id": 9261
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Indicators",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.unified_iocs}}",
                  "__bulk": true,
                  "condition": ""
                },
                "resource": {
                  "value": "{{vars.item.value}}",
                  "alerts": "{{vars.alerts_iris}}",
                  "__replace": "false",
                  "indicators": "{{vars.input.records[0]['@id']}}",
                  "indicatorStatus": {
                    "id": 369,
                    "@id": "/api/3/picklists/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "icon": null,
                    "@type": "Picklist",
                    "color": null,
                    "display": "TBD",
                    "@context": "/api/3/contexts/Picklist",
                    "listName": "/api/3/picklist_names/e6639d57-94a9-432f-a46f-b2b530402077",
                    "itemValue": "TBD",
                    "orderIndex": 3
                  },
                  "typeofindicator": "{{('IndicatorType' | picklist(vars.item.type))['@id']}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/indicators",
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "486",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "uuid": "c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "id": 9259
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": "You can customize extraction by modifying indicator map in configuration step",
              "arguments": {
                "ips": "{{globalVars.Excludelist_IPs.split(',')}}",
                "urls": "{{globalVars.Excludelist_URLs.split(',')}}",
                "domains": "{{globalVars.Excludelist_Domains.split(',')}}",
                "record_data": "{{(vars.input.records[0]['@id']+'?$relationships=true')|fromIRI}}",
                "unified_iocs": "[]"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "id": 9253
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Whitelist Indicators -> Create Indicators",
              "targetStep": "/api/3/workflow_steps/c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "sourceStep": "/api/3/workflow_steps/88edc781-d199-49de-ad68-7668b6699f6d",
              "label": null,
              "isExecuted": false,
              "uuid": "b8aaa6ed-2212-4681-a1e2-ba7dc075e31c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Indicators -> Update Record",
              "targetStep": "/api/3/workflow_steps/7d8a8527-3612-4918-b754-8524a80c1668",
              "sourceStep": "/api/3/workflow_steps/c42ab9bc-b2b1-4424-9a42-cad51c22e0ff",
              "label": null,
              "isExecuted": false,
              "uuid": "e14c8a11-5c02-4223-bab9-39ef144d3646"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute results -> Format File Metadata",
              "targetStep": "/api/3/workflow_steps/b4c730e5-50f3-4045-9890-22cce9ed1e7d",
              "sourceStep": "/api/3/workflow_steps/7fe93626-1500-436f-ac39-679f633dab41",
              "label": null,
              "isExecuted": false,
              "uuid": "4d59e90f-4f1f-41e1-ae8e-e8f9288f898c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Format File Metadata -> Whitelist Indicators",
              "targetStep": "/api/3/workflow_steps/88edc781-d199-49de-ad68-7668b6699f6d",
              "sourceStep": "/api/3/workflow_steps/b4c730e5-50f3-4045-9890-22cce9ed1e7d",
              "label": null,
              "isExecuted": false,
              "uuid": "4dc28c53-a5ed-490d-9c7d-3190137fd317"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Check Required Field",
              "targetStep": "/api/3/workflow_steps/234bf8de-f247-474f-8614-e0f214a28ab7",
              "sourceStep": "/api/3/workflow_steps/af26e67d-7790-45be-aa69-ce167cafc916",
              "label": null,
              "isExecuted": false,
              "uuid": "242dc715-153f-451e-83bc-310d7627e1a8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check Required Field -> Configuration",
              "targetStep": "/api/3/workflow_steps/e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "sourceStep": "/api/3/workflow_steps/234bf8de-f247-474f-8614-e0f214a28ab7",
              "label": null,
              "isExecuted": false,
              "uuid": "483dd201-9639-4062-a8f0-bd77225ac304"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Extract text",
              "targetStep": "/api/3/workflow_steps/1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "sourceStep": "/api/3/workflow_steps/e38d36c1-9c68-4cf7-9696-453dddfd2724",
              "label": null,
              "isExecuted": false,
              "uuid": "bd496cac-9af5-4b65-b3b1-6310b0e91fad"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract text -> Compute results",
              "targetStep": "/api/3/workflow_steps/7fe93626-1500-436f-ac39-679f633dab41",
              "sourceStep": "/api/3/workflow_steps/1ed3848a-f5c1-451c-9910-d2db0b9f3a42",
              "label": null,
              "isExecuted": false,
              "uuid": "5c200b93-8033-45fe-8487-98afba6d1c8c"
            }
          ],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "cddbc41c-740e-48f0-9657-9867b9254a4b",
          "recordTags": [
            "Use-Case",
            "file-content-extraction"
          ],
          "id": 1822,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1638265857,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1638265857,
          "owners": [],
          "isPrivate": false
        }
      ]
    }
  ],
  "macros": [
    {
      "name": "Excludelist_IPs",
      "value": "8.8.8.8,10.1.1.2",
      "default_value": "8.8.8.8,10.1.1.2"
    },
    {
      "name": "Excludelist_URLs",
      "value": "https://www.google.com,https://mail.yahoo.com/login.html,https://www.office.com/",
      "default_value": "https://www.google.com,https://mail.yahoo.com/login.html,https://www.office.com/"
    },
    {
      "name": "Excludelist_Domains",
      "value": "google.com,yahoo.com,fortinet.net,cybersponse.com,gmail.com,outlook.com,microsoft.com",
      "default_value": "google.com,yahoo.com,fortinet.net,cybersponse.com,gmail.com,outlook.com,microsoft.com"
    }
  ],
  "exported_tags": [
    "Use-Case",
    "file-content-extraction"
  ]
}